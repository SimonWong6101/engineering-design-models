$sth = $dbh->prepare("SELECT partid, filename FROM temp WHERE filename ~ \'\\\.sat\$\'");
$sth->execute() || die $sth->errstr;
$res = $sth->fetchall_arrayref();
for(my $i = 0; $i < @{$res}; $i++){
    my $png = substr($res->[$i][1],0 -3)."png";
    if(-f $png){
	print $