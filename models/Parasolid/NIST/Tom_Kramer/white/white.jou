(modeller start)
(load "plisp/load_functions.l")
(define workpiece body)
(workpiece receive "olps_workpiece_in.xmt_txt")
(translate_body 0.0 0.0 0.0)
(init_graphics)
(setq mrsev nil)
(princ "Save mrsev's? (y/n) ")
(cond ((equal (read) 'y) (setq mrsev t))
      (t nil))
(setq remos nil)
(princ "Save removed volumes? (y/n) ")
(cond ((equal (read) 'y) (setq remos t))
      (t nil))
(setq interm nil)
(princ "Save intermediates? (y/n) ")
(cond ((equal (read) 'y) (setq interm t))
      (t nil))
(make_pocket 'rectangular_pocket1 4.0 1.5 0.91 2.98 1.98 0.59 0.69)
(graphics sketch 'rectangular_pocket1)
(cond (mrsev
       (rectangular_pocket1 transmit "rectangular_pocket1"))
      (t nil))
(cond (remos
       (define removed body)
       (define interim body)
       (removed replicate 'rectangular_pocket1)
       (interim replicate 'workpiece)
       (removed intersect 'interim)
       (removed transmit "removed_1")
       (undefine interim)
       (undefine removed))
      (t nil))
(workpiece subtract 'rectangular_pocket1)
(graphics clear)
(graphics sketch 'workpiece)
(cond (interm
       (workpiece transmit "intermediate_1")
       (workpiece state 'new))
      (t nil))
(make_pocket 'rectangular_pocket2 4.0 1.5 0.9 3.0 2.0 0.6 0.7)
(graphics sketch 'rectangular_pocket2)
(cond (mrsev
       (rectangular_pocket2 transmit "rectangular_pocket2"))
      (t nil))
(cond (remos
       (define removed body)
       (define interim body)
       (removed replicate 'rectangular_pocket2)
       (interim replicate 'workpiece)
       (removed intersect 'interim)
       (removed transmit "removed_2")
       (undefine interim)
       (undefine removed))
      (t nil))
(workpiece subtract 'rectangular_pocket2)
(graphics clear)
(graphics sketch 'workpiece)
(cond (interm
       (workpiece transmit "intermediate_2")
       (workpiece state 'new))
      (t nil))
(make_center_drill_hole 'hole3 0.8 0.9 1.5 0.09 90.0)
(graphics sketch 'hole3)
(cond (mrsev
       (hole3 transmit "hole3"))
      (t nil))
(cond (remos
       (define removed body)
       (define interim body)
       (removed replicate 'hole3)
       (interim replicate 'workpiece)
       (removed intersect 'interim)
       (removed transmit "removed_3")
       (undefine interim)
       (undefine removed))
      (t nil))
(workpiece subtract 'hole3)
(graphics clear)
(graphics sketch 'workpiece)
(cond (interm
       (workpiece transmit "intermediate_3")
       (workpiece state 'new))
      (t nil))
(make_drill_hole 'hole4 0.8 0.9 -0.050000000000000044 1.55 0.25 118.0)
(graphics sketch 'hole4)
(cond (mrsev
       (hole4 transmit "hole4"))
      (t nil))
(cond (remos
       (define removed body)
       (define interim body)
       (removed replicate 'hole4)
       (interim replicate 'workpiece)
       (removed intersect 'interim)
       (removed transmit "removed_4")
       (undefine interim)
       (undefine removed))
      (t nil))
(workpiece subtract 'hole4)
(graphics clear)
(graphics sketch 'workpiece)
(cond (interm
       (workpiece transmit "intermediate_4")
       (workpiece state 'new))
      (t nil))
(workpiece merge)
(translate_body 0.0 0.0 0.0)
(workpiece transmit "olps_workpiece_out")
(graphics clear)
(graphics sketch 'workpiece)
(graphics ar)
-- (quit)
